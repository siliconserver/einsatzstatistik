#!/bin/bash
#
# script by christian baumann
# https://christian-baumann.net
# https://gitlab.com/wurzelserver
#
# variablen
hostname=localhost
username=feuerwehr
database=feuerwehr

echo "Letzter Einsatz"
echo "-------------"
psql $database $username << EOF
SELECT * FROM einsaetze ORDER BY nummer DESC LIMIT 1;
EOF
echo ""
echo ""
echo "Neuer Einsatz"
echo "-------------"
echo ""

# einlesen der daten
echo "Einsatz Nummer z.B. 104 : "
read nummer
echo "Beginn z.B. 2019-05-25 04:57:17 :"
read beginn
echo "Ende z.B. 2019-05-25 04:57:17 :"
read ende
echo "Ort z.B. Woerth :"
read ort
echo "Art des Einsatzes (Brand/TH/Gefahrstoffe/Dienstleistung): "
read art
echo "Funktion z.B. (FEZ, TM, AGT, MA) : "
read funktion
echo "Einsatzmittel z.B. (HLF20, DLK, FEZ) :"
read einsatzmittel
echo "Im Einsatz (true/false) : "
read eingesetzt
echo "Alarmierung z.B. Brennt PKW : "
read alarmierung
echo "Bemerkungen : "
read bemerkungen

# daten in db schreiben
echo "Schreibe Datensatz.."
echo "--------------------"
psql $database $username << EOF
INSERT INTO einsaetze (nummer,start,ende,ort,art,funktion,eingesetzt,alarmierung,bemerkungen,einsatzmittel) VALUES ('$nummer', '$beginn', '$ende', '$ort', '$art', '$funktion', '$eingesetzt', '$alarmierung', '$bemerkungen', '$einsatzmittel');
EOF

# geschriebene daten von db lesen
echo "Fertiiiig. Guck, hier:"
echo "----------------------"
psql $database $username << EOF
SELECT * FROM einsaetze WHERE nummer='$nummer';
EOF
